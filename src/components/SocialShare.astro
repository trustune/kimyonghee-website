---
interface Props {
  title: string;
  url: string;
  excerpt?: string;
  image?: string;
}

const { title, url, excerpt = '', image = '' } = Astro.props;

const shareUrl = encodeURIComponent(url);
const shareTitle = encodeURIComponent(title);
const shareExcerpt = excerpt ? encodeURIComponent(excerpt) : '';

const twitterText = excerpt
  ? encodeURIComponent(`${title}\n\n${excerpt}`)
  : shareTitle;

const blueskyText = excerpt
  ? `${title}\n\n${excerpt}\n\n${url}`
  : `${title}\n\n${url}`;

const links = [
  {
    label: 'Twitter',
    href: `https://twitter.com/intent/tweet?text=${twitterText}&url=${shareUrl}`,
    ariaLabel: 'Share on Twitter',
  },
  {
    label: 'Facebook',
    href: `https://www.facebook.com/sharer/sharer.php?u=${shareUrl}`,
    ariaLabel: 'Share on Facebook',
  },
  {
    label: 'LinkedIn',
    href: `https://www.linkedin.com/shareArticle?mini=true&url=${shareUrl}&title=${shareTitle}${excerpt ? `&summary=${shareExcerpt}` : ''}`,
    ariaLabel: 'Share on LinkedIn',
  },
  {
    label: 'Bluesky',
    href: `https://bsky.app/intent/compose?text=${encodeURIComponent(blueskyText)}`,
    ariaLabel: 'Share on Bluesky',
  },
];
---

<div class="social-share">
  <span class="social-share__label">Share</span>
  {links.map((link, i) => (
    <>
      <a
        href={link.href}
        target="_blank"
        rel="noopener noreferrer"
        class="social-share__link"
        aria-label={link.ariaLabel}
      >
        {link.label}
      </a>
      {i < links.length - 1 && <span class="social-share__sep">&middot;</span>}
    </>
  ))}
</div>

<style>
  .social-share {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-6) 0;
    border-top: 1px solid var(--color-border-light);
    font-size: 0.875rem;
  }

  .social-share__label {
    color: var(--color-text-muted);
    margin-right: var(--space-2);
  }

  .social-share__link {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .social-share__link:hover {
    color: var(--color-accent);
  }

  .social-share__sep {
    color: var(--color-text-muted);
    user-select: none;
  }
</style>
