---
import Analytics from "../components/Analytics.astro";

interface Props {
  title: string;
  description?: string;
  image?: string;
  url?: string;
}

const {
  title,
  description = "Media Policy & Management Expert",
  image,
  url = `https://kimyonghee.com${Astro.url.pathname}`,
} = Astro.props;
const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} | Yonghee Kim</title>
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article" />
    <meta property="og:url" content={url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    {
      image && (
        <>
          <meta property="og:image" content={image} />
          <meta property="og:image:secure_url" content={image} />
          <meta property="og:image:width" content="1200" />
          <meta property="og:image:height" content="630" />
          <meta property="og:image:alt" content={title} />
        </>
      )
    }
    <meta property="og:site_name" content="Yonghee Kim" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter -->
    <meta
      property="twitter:card"
      content={image ? "summary_large_image" : "summary"}
    />
    <meta property="twitter:url" content={url} />
    <meta property="twitter:title" content={`${title} | Yonghee Kim`} />
    <meta property="twitter:description" content={description} />
    {image && <meta property="twitter:image" content={image} />}

    <link
      rel="alternate"
      type="application/rss+xml"
      title="Yonghee Kim Blog"
      href="/rss.xml"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style is:global>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        /* Design Tokens */
        --font-primary: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        --font-heading: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;

        /* Colors - Clean Academic Palette */
        --color-text: #1a1a1a;
        --color-text-secondary: #525252;
        --color-link: #1e40af;
        --color-link-hover: #1e3a8a;
        --color-border: #d4d4d4;
        --color-bg: #ffffff;
        --color-bg-secondary: #fafafa;
        --color-accent: #1e40af;

        /* Layout - Responsive max-width */
        --max-width: min(900px, 90vw);
        --max-width-wide: min(1100px, 90vw);

        /* Responsive Typography - Reduced sizes */
        --font-size-base: clamp(0.875rem, 0.85rem + 0.15vw, 0.9375rem);
        --font-size-sm: clamp(0.75rem, 0.725rem + 0.1vw, 0.8125rem);
        --font-size-lg: clamp(0.9375rem, 0.9rem + 0.2vw, 1rem);
        --font-size-h1: clamp(1.5rem, 1.35rem + 0.75vw, 1.875rem);
        --font-size-h2: clamp(1.25rem, 1.15rem + 0.5vw, 1.5rem);
        --font-size-h3: clamp(1.0625rem, 1rem + 0.3vw, 1.25rem);
        --font-size-h4: clamp(0.9375rem, 0.9rem + 0.2vw, 1.0625rem);

        /* Spacing */
        --space-xs: clamp(0.5rem, 0.4rem + 0.5vw, 0.75rem);
        --space-sm: clamp(0.75rem, 0.6rem + 0.75vw, 1rem);
        --space-md: clamp(1rem, 0.8rem + 1vw, 1.5rem);
        --space-lg: clamp(1.5rem, 1.2rem + 1.5vw, 2rem);
        --space-xl: clamp(2rem, 1.5rem + 2vw, 3rem);
      }

      html {
        font-family: var(--font-primary);
        font-size: var(--font-size-base);
        line-height: 1.7;
        color: var(--color-text);
        background: var(--color-bg);
        scroll-behavior: smooth;
        -webkit-font-smoothing: antialiased;
      }

      body {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: var(--font-heading);
        font-weight: 600;
        line-height: 1.3;
        color: var(--color-text);
        margin-top: 1.75rem;
        margin-bottom: 0.75rem;
      }

      h1 {
        font-size: var(--font-size-h1);
      }
      h2 {
        font-size: var(--font-size-h2);
      }
      h3 {
        font-size: var(--font-size-h3);
      }
      h4 {
        font-size: var(--font-size-h4);
      }
      h5 {
        font-size: var(--font-size-lg);
      }
      h6 {
        font-size: var(--font-size-base);
      }

      p {
        margin-bottom: 1.5rem;
      }

      a {
        color: var(--color-link);
        text-decoration: underline;
        text-decoration-color: var(--color-border);
        text-underline-offset: 3px;
        transition: color 0.2s ease;
      }

      /* Hide ALL Korean content globally */
      [data-lang="ko"],
      *[data-lang="ko"] {
        display: none !important;
      }

      a:hover {
        color: var(--color-link-hover);
        text-decoration-color: var(--color-link-hover);
      }

      /* Responsive images */
      img {
        max-width: 100%;
        height: auto;
        display: block;
      }

      /* Responsive tables */
      table {
        width: 100%;
        border-collapse: collapse;
      }

      /* Responsive iframes and embeds */
      iframe,
      video,
      embed,
      object {
        max-width: 100%;
      }

      /* Prevent overflow */
      pre,
      code {
        overflow-x: auto;
        max-width: 100%;
      }
    </style>
    <Analytics />
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <nav class="nav">
          <a href="/" class="logo">Yonghee Kim</a>

          <!-- Mobile Menu Toggle -->
          <button class="mobile-menu-toggle" aria-label="Toggle menu">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </button>

          <!-- Desktop & Mobile Navigation -->
          <div class="nav-links">
            <a href="/" class={currentPath === "/" ? "active" : ""}>Home</a>
            <a
              href="/research/publications"
              class={currentPath.startsWith("/research") ? "active" : ""}
              >Research</a
            >
            <a
              href="/projects"
              class={currentPath.startsWith("/projects") ? "active" : ""}
              >Projects</a
            >
            <a
              href="/blog"
              class={currentPath.startsWith("/blog") ? "active" : ""}>Blog</a
            >
            <a href="/media" class={currentPath === "/media" ? "active" : ""}
              >Media</a
            >
            <a
              href="/teaching"
              class={currentPath.startsWith("/teaching") ||
              currentPath.startsWith("/courses")
                ? "active"
                : ""}>Teaching</a
            >
            <a href="/about" class={currentPath === "/about" ? "active" : ""}
              >About</a
            >
            <a href="/search" class={currentPath === "/search" ? "active" : ""}
              >Search</a
            >
          </div>
        </nav>
      </div>
    </header>

    <main class="site-main">
      <slot />
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="footer-content">
          <p>
            Yonghee Kim · Assistant Professor · Sunmoon University<br />
            <a href="mailto:yhkim1981@sunmoon.ac.kr">yhkim1981@sunmoon.ac.kr</a>
          </p>
          <p class="footer-links">
            <a href="https://github.com/yhkim1981-svg">GitHub</a> ·
            <a href="https://scholar.google.com">Google Scholar</a> ·
            <a href="https://bsky.app/profile/hastara.bsky.social">Bluesky</a> ·
            <a href="/rss.xml">RSS</a>
          </p>
          <p class="footer-note">© 2025 · Built with Astro</p>
        </div>
      </div>
    </footer>

    <style>
      .site-header {
        padding: var(--space-lg) 0 var(--space-md);
        background: transparent;
        position: static;
        border-bottom: 1px solid var(--color-border);
      }

      .container {
        max-width: var(--max-width);
        margin: 0 auto;
        padding: 0 var(--space-md);
      }

      .nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
      }

      .logo {
        font-family: var(--font-heading);
        font-size: 1.25rem;
        font-weight: 700;
        text-decoration: none;
        color: var(--color-text);
        z-index: 102;
        white-space: nowrap;
        flex-shrink: 0;
        margin-right: 2rem;
      }

      /* Mobile Menu Toggle */
      .mobile-menu-toggle {
        display: none;
        flex-direction: column;
        gap: 0.375rem;
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.5rem;
        z-index: 102;
      }

      .hamburger-line {
        width: 24px;
        height: 2px;
        background-color: var(--color-text);
        transition: all 0.3s ease;
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
        transform: rotate(45deg) translate(6px, 6px);
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
        opacity: 0;
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
        transform: rotate(-45deg) translate(6px, -6px);
      }

      /* Navigation Links */
      .nav-links {
        display: flex;
        gap: 2rem;
        align-items: center;
      }

      .nav-links a {
        text-decoration: none;
        font-size: 1rem;
        font-weight: 400;
        color: var(--color-text-secondary);
        padding: 0.25rem 0;
        transition: color 0.2s;
        white-space: nowrap;
      }

      .nav-links a:hover,
      .nav-links a.active {
        color: var(--color-text);
      }

      .site-main {
        flex: 1;
        width: 100%;
        padding: var(--space-xl) 0;
      }

      .site-footer {
        border-top: 1px solid var(--color-border);
        padding: var(--space-lg) 0;
        margin-top: var(--space-xl);
        background: transparent;
        font-size: var(--font-size-sm);
      }

      .footer-content {
        text-align: center;
        color: var(--color-text-secondary);
      }

      .footer-content p {
        margin-bottom: 0.75rem;
      }

      .footer-links a {
        color: var(--color-text-secondary);
        text-decoration: none;
        margin: 0 0.5rem;
      }

      .footer-links a:hover {
        color: var(--color-link);
      }

      .footer-note {
        font-size: 0.85rem;
        opacity: 0.7;
      }

      /* Tablet - Adjust navigation */
      @media (max-width: 900px) {
        .nav-links {
          gap: 1rem;
        }

        .nav-links a {
          font-size: var(--font-size-sm);
        }
      }

      /* Mobile - Show hamburger menu */
      @media (max-width: 768px) {
        /* Show mobile menu toggle */
        .mobile-menu-toggle {
          display: flex;
        }

        /* Mobile Navigation */
        .nav-links {
          position: fixed;
          top: 0;
          right: -100%;
          width: min(280px, 85vw);
          height: 100vh;
          background: var(--color-bg);
          flex-direction: column;
          gap: 0;
          padding: 5rem var(--space-lg) var(--space-lg);
          box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
          transition: right 0.3s ease;
          z-index: 101;
          overflow-y: auto;
        }

        .nav-links.active {
          right: 0;
        }

        .nav-links a {
          width: 100%;
          padding: var(--space-sm) 0;
          border-bottom: 1px solid var(--color-border);
          font-size: var(--font-size-base);
        }

        .nav-links a:hover,
        .nav-links a.active {
          border-bottom-color: var(--color-accent);
          background: rgba(30, 64, 175, 0.05);
          padding-left: var(--space-sm);
        }
      }
    </style>

    <script>
      // Mobile Menu Toggle
      document.addEventListener("DOMContentLoaded", () => {
        const menuToggle = document.querySelector(".mobile-menu-toggle");
        const navLinks = document.querySelector(".nav-links");

        if (menuToggle && navLinks) {
          menuToggle.addEventListener("click", () => {
            menuToggle.classList.toggle("active");
            navLinks.classList.toggle("active");

            // Prevent body scroll when menu is open
            document.body.style.overflow = navLinks.classList.contains("active")
              ? "hidden"
              : "";
          });

          // Close menu when clicking on a link
          const links = navLinks.querySelectorAll("a");
          links.forEach((link) => {
            link.addEventListener("click", () => {
              menuToggle.classList.remove("active");
              navLinks.classList.remove("active");
              document.body.style.overflow = "";
            });
          });

          // Close menu when clicking outside
          document.addEventListener("click", (e) => {
            if (
              !navLinks.contains(e.target as Node) &&
              !menuToggle.contains(e.target as Node)
            ) {
              menuToggle.classList.remove("active");
              navLinks.classList.remove("active");
              document.body.style.overflow = "";
            }
          });
        }
      });
    </script>
  </body>
</html>
