---
import BaseLayout from '../../layouts/BaseLayout.astro';
import projectsData from '../../data/projects.json';

export async function getStaticPaths() {
  const projects = projectsData.projects || [];
  return projects.map(project => ({
    params: { slug: project.id },
    props: { project }
  }));
}

const { project } = Astro.props;

// Load data for broadcasting project
let chartData = null;
let detailedData = null;
if (project.id === 'broadcasting-revenue-2015-2024') {
  try {
    const fs = await import('fs/promises');
    const path = await import('path');
    const dataPath = path.join(process.cwd(), 'public', 'projects', 'broadcasting', 'net_inflow_summary.json');
    const data = await fs.readFile(dataPath, 'utf-8');
    chartData = JSON.parse(data);

    const detailedPath = path.join(process.cwd(), 'public', 'projects', 'broadcasting', 'detailed_analysis.json');
    const detailedStr = await fs.readFile(detailedPath, 'utf-8');
    detailedData = JSON.parse(detailedStr);
  } catch (error) {
    console.error('Failed to load chart data:', error);
  }
}
---

<BaseLayout title={`${project.title} - Projects`} description={project.description}>
  <div class="project-detail">
    <header class="project-header">
      <div class="breadcrumb">
        <a href="/projects">Projects</a> / {project.title}
      </div>
      <h1 class="project-title">{project.title}</h1>
      <p class="project-title-en">{project.title_en}</p>
      {project.subtitle && (
        <>
          <p class="project-subtitle">{project.subtitle}</p>
          {project.subtitle_en && <p class="project-subtitle-en">{project.subtitle_en}</p>}
        </>
      )}

      <div class="project-meta">
        <span class="meta-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          {new Date(project.date).toLocaleDateString('ko-KR')}
        </span>
        <span class="meta-item category">{project.category}</span>
        {project.conference && (
          <span class="meta-item conference">{project.conference}</span>
        )}
        {project.verification_accuracy && (
          <span class="meta-item accuracy">
            ê²€ì¦ ì •í™•ë„: {project.verification_accuracy}
          </span>
        )}
      </div>
    </header>

    <div class="project-content">
      <section class="section">
        <h2 data-lang="en">Overview</h2>
        <h2 data-lang="ko">ê°œìš”</h2>
        <p class="description">{project.description}</p>
        <p class="description-en">{project.description_en}</p>
      </section>

      {project.key_findings && (
        <section class="section key-findings-section">
          <h2 data-lang="en">Key Findings</h2>
          <h2 data-lang="ko">ì£¼ìš” ë°œê²¬ì‚¬í•­</h2>
          <div class="findings-grid">
            {project.key_findings.map((finding, index) => (
              <div class="finding-card">
                <div class="finding-number">{index + 1}</div>
                <p>{finding}</p>
              </div>
            ))}
          </div>
        </section>
      )}

      {detailedData && (
        <>
          <section class="section analysis-section">
            <h2 data-lang="en">I. Structural Analysis: The Illusion of Nominal Growth</h2>
            <h2 data-lang="ko">I. êµ¬ì¡° ë¶„ì„: ëª…ëª© ì„±ì¥ì˜ í—ˆìƒ</h2>

            <div class="analysis-card warning">
              <h3>ëª…ëª© ì„±ì¥ vs ì‹¤ì§ˆ ì„±ì¥</h3>
              <div class="comparison-grid">
                <div class="comparison-item">
                  <div class="label">ì „ì²´ ì¬ì› (2015â†’2024)</div>
                  <div class="value positive">+{detailedData.nominal_vs_real.total_growth}%</div>
                  <div class="amount">{detailedData.nominal_vs_real.total_revenue_2015.toLocaleString()}ì–µ â†’ {detailedData.nominal_vs_real.total_revenue_2024.toLocaleString()}ì–µ</div>
                </div>
                <div class="comparison-item">
                  <div class="label">ìˆœìœ ì…ì¬ì› (2015â†’2024)</div>
                  <div class="value neutral">+{detailedData.nominal_vs_real.net_growth}%</div>
                  <div class="amount">{detailedData.nominal_vs_real.net_inflow_2015.toLocaleString()}ì–µ â†’ {detailedData.nominal_vs_real.net_inflow_2024.toLocaleString()}ì–µ</div>
                </div>
                <div class="comparison-item">
                  <div class="label">ë‚´ë¶€ê±°ë˜ (2015â†’2024)</div>
                  <div class="value warning">+{detailedData.nominal_vs_real.internal_growth}%</div>
                  <div class="amount">{detailedData.nominal_vs_real.internal_trade_2015.toLocaleString()}ì–µ â†’ {detailedData.nominal_vs_real.internal_trade_2024.toLocaleString()}ì–µ</div>
                </div>
              </div>
              <div class="insight">
                <strong>í•µì‹¬ ì¸ì‚¬ì´íŠ¸:</strong> ì „ì²´ ì¬ì›ì€ 18.9% ì¦ê°€í–ˆìœ¼ë‚˜, ì‹¤ì œ ì™¸ë¶€ìœ ì…(ìˆœìœ ì…)ì€ 0.1% ì •ì²´.
                ë‚´ë¶€ê±°ë˜ê°€ 35.0% ê¸‰ì¦í•˜ë©° ëª…ëª© ì„±ì¥ì„ ë§Œë“¤ì–´ëƒˆìŠµë‹ˆë‹¤.
                ìˆœìœ ì… ë¹„ì¤‘ì€ {detailedData.nominal_vs_real.net_inflow_ratio_2015}% â†’ {detailedData.nominal_vs_real.net_inflow_ratio_2024}%ë¡œ 7.3%p í•˜ë½í–ˆìŠµë‹ˆë‹¤.
              </div>
            </div>
          </section>

          <section class="section analysis-section">
            <h2 data-lang="en">II. Crisis Diagnosis: Advertising Collapse</h2>
            <h2 data-lang="ko">II. ìœ„ê¸° ì§„ë‹¨: ê´‘ê³  ë¶•ê´´</h2>

            <div class="crisis-grid">
              <div class="crisis-card negative">
                <div class="crisis-icon">ğŸ“‰</div>
                <h3>ë°©ì†¡ê´‘ê³  ë¶•ê´´</h3>
                <div class="crisis-stat">{detailedData.advertising_collapse.broadcast_decline}%</div>
                <div class="crisis-detail">
                  {detailedData.advertising_collapse.broadcast_ad_2015.toLocaleString()}ì–µ (2015) â†’
                  {detailedData.advertising_collapse.broadcast_ad_2024.toLocaleString()}ì–µ (2024)
                </div>
                <div class="crisis-trend">
                  ì—°í‰ê·  {detailedData.advertising_collapse.annual_decline.toLocaleString()}ì–µì› ê°ì†Œ<br/>
                  2030ë…„ ì˜ˆìƒ: {detailedData.advertising_collapse.prediction_2030.toLocaleString()}ì–µì›
                </div>
              </div>

              <div class="crisis-card positive">
                <div class="crisis-icon">ğŸ“ˆ</div>
                <h3>ë””ì§€í„¸ê´‘ê³  ê¸‰ì„±ì¥</h3>
                <div class="crisis-stat">+{detailedData.advertising_collapse.digital_growth}%</div>
                <div class="crisis-detail">
                  {detailedData.advertising_collapse.digital_ad_2015.toLocaleString()}ì–µ (2015) â†’
                  {detailedData.advertising_collapse.digital_ad_2024.toLocaleString()}ì–µ (2024)
                </div>
                <div class="crisis-trend">
                  10ë…„ê°„ 3.8ë°° ì„±ì¥<br/>
                  ë°©ì†¡ê´‘ê³  ì ìœ ìœ¨ ì—­ì „
                </div>
              </div>
            </div>
          </section>

          <section class="section analysis-section">
            <h2 data-lang="en">III. Policy Failure: KBS License Fee Freeze</h2>
            <h2 data-lang="ko">III. ì •ì±… ì‹¤íŒ¨: KBS ìˆ˜ì‹ ë£Œ 44ë…„ ë™ê²°</h2>

            <div class="analysis-card critical">
              <div class="freeze-stats">
                <div class="freeze-item">
                  <div class="freeze-label">ë™ê²° ê¸°ê°„</div>
                  <div class="freeze-value">{detailedData.kbs_license.frozen_years}ë…„</div>
                  <div class="freeze-sub">1981ë…„ ì´í›„</div>
                </div>
                <div class="freeze-item">
                  <div class="freeze-label">ìˆ˜ì‹ ë£Œ</div>
                  <div class="freeze-value">{detailedData.kbs_license.fee_1981.toLocaleString()}ì›</div>
                  <div class="freeze-sub">ë³€ë™ ì—†ìŒ</div>
                </div>
                <div class="freeze-item">
                  <div class="freeze-label">ì‹¤ì§ˆê°€ì¹˜ í•˜ë½</div>
                  <div class="freeze-value">{detailedData.kbs_license.real_value_decline}%</div>
                  <div class="freeze-sub">ë¬¼ê°€ìƒìŠ¹ ë¯¸ë°˜ì˜</div>
                </div>
              </div>
              <div class="economic-loss">
                <div class="loss-row">
                  <span>ì—°ê°„ ì†ì‹¤</span>
                  <strong>{detailedData.kbs_license.annual_loss.toLocaleString()}ì–µì›</strong>
                </div>
                <div class="loss-row total">
                  <span>ëˆ„ì  ì†ì‹¤ (1981-2024)</span>
                  <strong>{detailedData.kbs_license.accumulated_loss.toLocaleString()}ì–µì›</strong>
                </div>
              </div>
            </div>
          </section>

          <section class="section analysis-section">
            <h2 data-lang="en">IV. The Cost of Policy Delay</h2>
            <h2 data-lang="ko">IV. ì •ì±… ì§€ì—°ì˜ ëŒ€ê°€</h2>

            <div class="analysis-card urgent">
              <div class="cost-breakdown">
                <div class="cost-item">
                  <div class="cost-label">KBS ìˆ˜ì‹ ë£Œ ë™ê²° ì†ì‹¤</div>
                  <div class="cost-value">{detailedData.policy_cost.kbs_freeze_loss.toLocaleString()}ì–µì›</div>
                </div>
                <div class="cost-item">
                  <div class="cost-label">ê´‘ê³  ê·œì œ ì§€ì—° ì†ì‹¤</div>
                  <div class="cost-value">{detailedData.policy_cost.ad_regulation_delay.toLocaleString()}ì–µì›</div>
                </div>
                <div class="cost-separator"></div>
                <div class="cost-item total">
                  <div class="cost-label">ì´ ëˆ„ì  ì†ì‹¤</div>
                  <div class="cost-value highlight">{detailedData.policy_cost.total_loss.toLocaleString()}ì–µì›</div>
                </div>
              </div>
              <div class="deadline-warning">
                <div class="warning-icon">âš ï¸</div>
                <div class="warning-text">
                  <strong>ê³¨ë“ íƒ€ì„: {detailedData.policy_cost.golden_time}ë…„ê¹Œì§€</strong>
                  <p>í†µí•©ì •ì±… ì‹¤í–‰ì´ ì§€ì—°ë ìˆ˜ë¡ ì‚°ì—… íšŒë³µ ë¹„ìš©ì€ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•©ë‹ˆë‹¤.</p>
                </div>
              </div>
            </div>
          </section>

          <section class="section analysis-section">
            <h2 data-lang="en">V. Broadcasting Fund Structure</h2>
            <h2 data-lang="ko">V. ë°©ì†¡ë°œì „ê¸°ê¸ˆ êµ¬ì¡°</h2>

            <div class="fund-overview">
              <div class="fund-total">
                <div class="fund-label">2024ë…„ ì´ ê¸°ê¸ˆ</div>
                <div class="fund-amount">{detailedData.broadcast_fund.total.toLocaleString()}ì–µì›</div>
              </div>
              <div class="fund-sources">
                <div class="fund-source telecom">
                  <div class="source-name">í†µì‹ ì‚¬ì—…ì</div>
                  <div class="source-amount">{detailedData.broadcast_fund.telecom.toLocaleString()}ì–µì›</div>
                  <div class="source-ratio">{detailedData.broadcast_fund.telecom_ratio}%</div>
                </div>
                <div class="fund-source broadcast">
                  <div class="source-name">ë°©ì†¡ì‚¬ì—…ì</div>
                  <div class="source-amount">{detailedData.broadcast_fund.broadcast.toLocaleString()}ì–µì›</div>
                  <div class="source-ratio">{detailedData.broadcast_fund.broadcast_ratio}%</div>
                </div>
              </div>
              <div class="platform-burden">
                <strong>í”Œë«í¼ ë¶€ë‹´ í˜„í™©:</strong>
                í”Œë«í¼ ë§¤ì¶œ {detailedData.broadcast_fund.platform_revenue.toLocaleString()}ì–µì› ëŒ€ë¹„
                {detailedData.broadcast_fund.platform_burden.toLocaleString()}ì–µì› ë¶€ë‹´
                (ë¶€ë‹´ë¥  {detailedData.broadcast_fund.burden_rate}%)
              </div>
            </div>
          </section>
        </>
      )}

      {chartData && (
        <section class="section charts-section">
          <h2 data-lang="en">Data Visualization</h2>
          <h2 data-lang="ko">ë°ì´í„° ì‹œê°í™”</h2>

          <div class="chart-container">
            <h3 data-lang="en">10-Year Revenue Trend (2015-2024)</h3>
            <h3 data-lang="ko">10ë…„ê°„ ì¬ì› ì¶”ì´ (2015-2024)</h3>
            <canvas id="trendChart"></canvas>
          </div>

          <div class="chart-container">
            <h3 data-lang="en">Revenue Structure Comparison (2015 vs 2024)</h3>
            <h3 data-lang="ko">ì¬ì› êµ¬ì¡° ë¹„êµ (2015 vs 2024)</h3>
            <canvas id="comparisonChart"></canvas>
          </div>

          <div class="chart-container">
            <h3 data-lang="en">Revenue Breakdown by Source (2024)</h3>
            <h3 data-lang="ko">ì¬ì›ë³„ êµ¬ì„± (2024)</h3>
            <canvas id="breakdownChart"></canvas>
          </div>
        </section>
      )}

      {project.policy_proposals && project.policy_proposals.length > 0 && (
        <section class="section policy-section">
          <h2 data-lang="en">Policy Proposals</h2>
          <h2 data-lang="ko">ì •ì±… ì œì•ˆ</h2>
          <div class="policy-grid">
            {project.policy_proposals.map((proposal, index) => (
              <div class="policy-card">
                <div class="policy-number">{index + 1}</div>
                <p>{proposal}</p>
              </div>
            ))}
          </div>
        </section>
      )}

      {project.technologies && (
        <section class="section">
          <h2 data-lang="en">Technologies Used</h2>
          <h2 data-lang="ko">ì‚¬ìš© ê¸°ìˆ </h2>
          <div class="tech-tags">
            {project.technologies.map((tech) => (
              <span class="tech-tag">{tech}</span>
            ))}
          </div>
        </section>
      )}
    </div>
  </div>

  {chartData && (
    <>
      <script is:inline src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
      <script is:inline define:vars={{ chartData }}>
        // Trend Chart
        const trendCtx = document.getElementById('trendChart');
        if (trendCtx) {
          new Chart(trendCtx, {
            type: 'line',
            data: {
              labels: chartData.map(d => d.year + 'ë…„'),
              datasets: [
                {
                  label: 'ìœ ë£Œë°©ì†¡ìˆ˜ì‹ ë£Œ',
                  data: chartData.map(d => d.subscription_fee),
                  borderColor: '#2563eb',
                  backgroundColor: 'rgba(37, 99, 235, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'ë°©ì†¡ê´‘ê³ ',
                  data: chartData.map(d => d.broadcasting_ad),
                  borderColor: '#dc2626',
                  backgroundColor: 'rgba(220, 38, 38, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'í™ˆì‡¼í•‘ì†¡ì¶œìˆ˜ìˆ˜ë£Œ',
                  data: chartData.map(d => d.homeshop_fee),
                  borderColor: '#16a34a',
                  backgroundColor: 'rgba(22, 163, 74, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'KBSìˆ˜ì‹ ë£Œ',
                  data: chartData.map(d => d.kbs_fee),
                  borderColor: '#ca8a04',
                  backgroundColor: 'rgba(202, 138, 4, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'ë°©ë°œê¸°ê¸ˆ',
                  data: chartData.map(d => d.broadcast_fund),
                  borderColor: '#9333ea',
                  backgroundColor: 'rgba(147, 51, 234, 0.1)',
                  tension: 0.4
                }
              ]
            },
            options: {
              responsive: true,
              maintainAspectRatio: true,
              plugins: {
                legend: {
                  position: 'top',
                },
                tooltip: {
                  callbacks: {
                    label: function(context) {
                      return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + 'ì–µì›';
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: {
                    callback: function(value) {
                      return value.toLocaleString() + 'ì–µì›';
                    }
                  }
                }
              }
            }
          });
        }

        // Comparison Chart
        const comparisonCtx = document.getElementById('comparisonChart');
        if (comparisonCtx) {
          const data2015 = chartData.find(d => d.year === 2015);
          const data2024 = chartData.find(d => d.year === 2024);

          new Chart(comparisonCtx, {
            type: 'bar',
            data: {
              labels: ['ìœ ë£Œë°©ì†¡ìˆ˜ì‹ ë£Œ', 'ë°©ì†¡ê´‘ê³ ', 'í™ˆì‡¼í•‘ì†¡ì¶œìˆ˜ìˆ˜ë£Œ', 'KBSìˆ˜ì‹ ë£Œ', 'ë°©ë°œê¸°ê¸ˆ'],
              datasets: [
                {
                  label: '2015ë…„',
                  data: [
                    data2015.subscription_fee,
                    data2015.broadcasting_ad,
                    data2015.homeshop_fee,
                    data2015.kbs_fee,
                    data2015.broadcast_fund
                  ],
                  backgroundColor: 'rgba(37, 99, 235, 0.7)',
                },
                {
                  label: '2024ë…„',
                  data: [
                    data2024.subscription_fee,
                    data2024.broadcasting_ad,
                    data2024.homeshop_fee,
                    data2024.kbs_fee,
                    data2024.broadcast_fund
                  ],
                  backgroundColor: 'rgba(220, 38, 38, 0.7)',
                }
              ]
            },
            options: {
              responsive: true,
              plugins: {
                tooltip: {
                  callbacks: {
                    label: function(context) {
                      return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + 'ì–µì›';
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: {
                    callback: function(value) {
                      return value.toLocaleString() + 'ì–µì›';
                    }
                  }
                }
              }
            }
          });
        }

        // Breakdown Chart (Horizontal Bar)
        const breakdownCtx = document.getElementById('breakdownChart');
        if (breakdownCtx) {
          const data2024 = chartData.find(d => d.year === 2024);
          const total = data2024.subscription_fee + data2024.broadcasting_ad +
                       data2024.homeshop_fee + data2024.kbs_fee + data2024.broadcast_fund;

          const dataValues = [
            data2024.subscription_fee,
            data2024.broadcasting_ad,
            data2024.homeshop_fee,
            data2024.kbs_fee,
            data2024.broadcast_fund
          ];

          const percentages = dataValues.map(val => ((val / total) * 100).toFixed(1));

          new Chart(breakdownCtx, {
            type: 'bar',
            data: {
              labels: ['ìœ ë£Œë°©ì†¡ìˆ˜ì‹ ë£Œ', 'ë°©ì†¡ê´‘ê³ ', 'í™ˆì‡¼í•‘ì†¡ì¶œìˆ˜ìˆ˜ë£Œ', 'KBSìˆ˜ì‹ ë£Œ', 'ë°©ë°œê¸°ê¸ˆ'],
              datasets: [{
                data: dataValues,
                backgroundColor: [
                  'rgba(37, 99, 235, 0.85)',
                  'rgba(220, 38, 38, 0.85)',
                  'rgba(22, 163, 74, 0.85)',
                  'rgba(202, 138, 4, 0.85)',
                  'rgba(147, 51, 234, 0.85)'
                ],
                borderWidth: 0
              }]
            },
            options: {
              indexAxis: 'y',
              responsive: true,
              maintainAspectRatio: true,
              plugins: {
                legend: {
                  display: false
                },
                tooltip: {
                  callbacks: {
                    label: function(context) {
                      const percentage = percentages[context.dataIndex];
                      return context.parsed.x.toLocaleString() + 'ì–µì› (' + percentage + '%)';
                    }
                  }
                },
                datalabels: {
                  display: false
                }
              },
              scales: {
                x: {
                  beginAtZero: true,
                  ticks: {
                    callback: function(value) {
                      return value.toLocaleString() + 'ì–µ';
                    }
                  }
                },
                y: {
                  ticks: {
                    font: {
                      size: 13,
                      weight: '500'
                    }
                  }
                }
              },
              layout: {
                padding: {
                  right: 80
                }
              }
            },
            plugins: [{
              id: 'percentageLabels',
              afterDatasetsDraw: function(chart) {
                const ctx = chart.ctx;
                chart.data.datasets.forEach(function(dataset, i) {
                  const meta = chart.getDatasetMeta(i);
                  meta.data.forEach(function(bar, index) {
                    const data = dataset.data[index];
                    const percentage = percentages[index];

                    ctx.fillStyle = '#1f2937';
                    ctx.font = 'bold 13px sans-serif';
                    ctx.textAlign = 'left';
                    ctx.textBaseline = 'middle';

                    const text = percentage + '%';
                    const xPos = bar.x + 10;
                    const yPos = bar.y;

                    ctx.fillText(text, xPos, yPos);
                  });
                });
              }
            }]
          });
        }
      </script>
    </>
  )}
</BaseLayout>

<style>
  .project-detail {
    max-width: 1200px;
    margin: 0 auto;
    padding: 3rem 1.5rem;
  }

  .project-header {
    margin-bottom: 3rem;
  }

  .breadcrumb {
    font-size: 0.875rem;
    color: #6b7280;
    margin-bottom: 1rem;
  }

  .breadcrumb a {
    color: #2563eb;
    text-decoration: none;
  }

  .breadcrumb a:hover {
    text-decoration: underline;
  }

  .project-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #1e40af;
    margin-bottom: 0.5rem;
    line-height: 1.2;
  }

  .project-title-en {
    font-size: 1.25rem;
    color: #6b7280;
    font-style: italic;
    margin-bottom: 0.5rem;
  }

  .project-subtitle {
    font-size: 1.125rem;
    color: #4b5563;
    font-weight: 500;
    margin-bottom: 0.5rem;
  }

  .project-subtitle-en {
    font-size: 1rem;
    color: #6b7280;
    font-style: italic;
    margin-bottom: 1.5rem;
  }

  .project-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .meta-item {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.5rem 1rem;
    background: #f3f4f6;
    color: #4b5563;
    font-size: 0.875rem;
    border-radius: 0.25rem;
  }

  .meta-item svg {
    flex-shrink: 0;
  }

  .meta-item.category {
    background: #dbeafe;
    color: #1e40af;
    font-weight: 600;
  }

  .meta-item.conference {
    background: #dcfce7;
    color: #166534;
  }

  .meta-item.accuracy {
    background: #fef3c7;
    color: #92400e;
    font-weight: 600;
  }

  .project-content {
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .section h2 {
    font-size: 1.875rem;
    color: #1f2937;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #e5e7eb;
  }

  .description,
  .description-en {
    font-size: 1.125rem;
    line-height: 1.7;
    color: #4b5563;
    margin-bottom: 1rem;
  }

  .description-en {
    font-style: italic;
    color: #6b7280;
  }

  .findings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .finding-card {
    position: relative;
    padding: 1.5rem;
    padding-left: 4rem;
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    border-left: 4px solid #2563eb;
    border-radius: 0.5rem;
  }

  .finding-number {
    position: absolute;
    top: 1.5rem;
    left: 1.5rem;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #2563eb;
    color: white;
    font-weight: 700;
    border-radius: 50%;
    font-size: 1rem;
  }

  .finding-card p {
    color: #1f2937;
    font-weight: 500;
    line-height: 1.6;
  }

  .chart-container {
    background: white;
    padding: 2rem;
    border: 1px solid #e5e7eb;
    border-radius: 0.75rem;
    margin-bottom: 2rem;
  }

  .chart-container h3 {
    font-size: 1.25rem;
    color: #1f2937;
    margin-bottom: 1.5rem;
  }

  .chart-container canvas {
    max-height: 400px;
  }

  .policy-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .policy-card {
    position: relative;
    padding: 1.5rem;
    padding-left: 4rem;
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border-left: 4px solid #f59e0b;
    border-radius: 0.5rem;
  }

  .policy-number {
    position: absolute;
    top: 1.5rem;
    left: 1.5rem;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f59e0b;
    color: white;
    font-weight: 700;
    border-radius: 50%;
    font-size: 1rem;
  }

  .policy-card p {
    color: #78350f;
    font-weight: 600;
    line-height: 1.6;
  }

  .tech-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .tech-tag {
    padding: 0.5rem 1.25rem;
    background: #f3f4f6;
    color: #1f2937;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: 9999px;
    border: 1px solid #d1d5db;
  }

  /* Analysis sections */
  .analysis-section {
    background: #fafbfc;
    padding: 2rem;
    border-radius: 1rem;
  }

  .analysis-card {
    background: white;
    padding: 2rem;
    border-radius: 0.75rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }

  .analysis-card.warning {
    border-left: 5px solid #f59e0b;
  }

  .analysis-card.critical {
    border-left: 5px solid #dc2626;
  }

  .analysis-card.urgent {
    border-left: 5px solid #7c3aed;
  }

  .analysis-card h3 {
    font-size: 1.375rem;
    color: #1f2937;
    margin-bottom: 1.5rem;
    font-weight: 600;
  }

  /* Comparison Grid */
  .comparison-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .comparison-item {
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 0.5rem;
    text-align: center;
  }

  .comparison-item .label {
    font-size: 0.875rem;
    color: #6b7280;
    margin-bottom: 0.75rem;
    font-weight: 500;
  }

  .comparison-item .value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }

  .comparison-item .value.positive {
    color: #16a34a;
  }

  .comparison-item .value.neutral {
    color: #6b7280;
  }

  .comparison-item .value.warning {
    color: #dc2626;
  }

  .comparison-item .amount {
    font-size: 0.875rem;
    color: #4b5563;
  }

  .insight {
    background: #fffbeb;
    padding: 1.25rem;
    border-radius: 0.5rem;
    border-left: 3px solid #f59e0b;
    font-size: 0.938rem;
    line-height: 1.6;
    color: #78350f;
  }

  .insight strong {
    color: #92400e;
  }

  /* Crisis Grid */
  .crisis-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .crisis-card {
    background: white;
    padding: 2rem;
    border-radius: 0.75rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  .crisis-card.negative {
    border: 2px solid #fca5a5;
    background: linear-gradient(135deg, #ffffff 0%, #fee2e2 100%);
  }

  .crisis-card.positive {
    border: 2px solid #86efac;
    background: linear-gradient(135deg, #ffffff 0%, #dcfce7 100%);
  }

  .crisis-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .crisis-card h3 {
    font-size: 1.25rem;
    color: #1f2937;
    margin-bottom: 1rem;
    font-weight: 600;
  }

  .crisis-stat {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }

  .crisis-card.negative .crisis-stat {
    color: #dc2626;
  }

  .crisis-card.positive .crisis-stat {
    color: #16a34a;
  }

  .crisis-detail {
    font-size: 1rem;
    color: #4b5563;
    margin-bottom: 1rem;
    line-height: 1.6;
  }

  .crisis-trend {
    font-size: 0.875rem;
    color: #6b7280;
    line-height: 1.6;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
  }

  /* Freeze Stats */
  .freeze-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .freeze-item {
    text-align: center;
    padding: 1.5rem;
    background: #fef2f2;
    border-radius: 0.5rem;
  }

  .freeze-label {
    font-size: 0.813rem;
    color: #7f1d1d;
    margin-bottom: 0.5rem;
    font-weight: 500;
  }

  .freeze-value {
    font-size: 2rem;
    font-weight: 700;
    color: #dc2626;
    margin-bottom: 0.25rem;
  }

  .freeze-sub {
    font-size: 0.75rem;
    color: #991b1b;
  }

  .economic-loss {
    background: #7f1d1d;
    color: white;
    padding: 1.5rem;
    border-radius: 0.5rem;
  }

  .loss-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    font-size: 1rem;
  }

  .loss-row.total {
    border-top: 2px solid rgba(255, 255, 255, 0.3);
    margin-top: 0.5rem;
    padding-top: 1rem;
    font-size: 1.125rem;
  }

  .loss-row strong {
    font-size: 1.375rem;
    font-weight: 700;
  }

  .loss-row.total strong {
    font-size: 1.75rem;
  }

  /* Cost Breakdown */
  .cost-breakdown {
    background: #f5f3ff;
    padding: 2rem;
    border-radius: 0.75rem;
    margin-bottom: 1.5rem;
  }

  .cost-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 0;
  }

  .cost-label {
    font-size: 1rem;
    color: #4c1d95;
    font-weight: 500;
  }

  .cost-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #6d28d9;
  }

  .cost-separator {
    height: 2px;
    background: linear-gradient(to right, transparent, #c4b5fd, transparent);
    margin: 1rem 0;
  }

  .cost-item.total {
    padding-top: 1.5rem;
  }

  .cost-item.total .cost-label {
    font-size: 1.25rem;
    color: #3730a3;
  }

  .cost-item.total .cost-value.highlight {
    font-size: 2.25rem;
    color: #5b21b6;
  }

  .deadline-warning {
    display: flex;
    gap: 1rem;
    background: #fef3c7;
    padding: 1.5rem;
    border-radius: 0.75rem;
    border-left: 4px solid #f59e0b;
  }

  .warning-icon {
    font-size: 2rem;
    flex-shrink: 0;
  }

  .warning-text strong {
    display: block;
    color: #92400e;
    font-size: 1.125rem;
    margin-bottom: 0.5rem;
  }

  .warning-text p {
    color: #78350f;
    font-size: 0.938rem;
    line-height: 1.5;
    margin: 0;
  }

  /* Fund Overview */
  .fund-overview {
    background: white;
    padding: 2rem;
    border-radius: 0.75rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }

  .fund-total {
    text-align: center;
    padding: 1.5rem;
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    border-radius: 0.5rem;
    margin-bottom: 2rem;
  }

  .fund-label {
    font-size: 0.938rem;
    color: #1e40af;
    margin-bottom: 0.5rem;
    font-weight: 600;
  }

  .fund-amount {
    font-size: 2.5rem;
    font-weight: 700;
    color: #1e3a8a;
  }

  .fund-sources {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .fund-source {
    padding: 1.5rem;
    border-radius: 0.5rem;
    text-align: center;
  }

  .fund-source.telecom {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  }

  .fund-source.broadcast {
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
  }

  .source-name {
    font-size: 0.938rem;
    margin-bottom: 0.75rem;
    font-weight: 600;
    color: #1f2937;
  }

  .source-amount {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }

  .fund-source.telecom .source-amount {
    color: #92400e;
  }

  .fund-source.broadcast .source-amount {
    color: #1e40af;
  }

  .source-ratio {
    font-size: 1.125rem;
    font-weight: 600;
    opacity: 0.8;
  }

  .platform-burden {
    background: #f9fafb;
    padding: 1.25rem;
    border-radius: 0.5rem;
    font-size: 0.938rem;
    line-height: 1.6;
    color: #4b5563;
  }

  .platform-burden strong {
    color: #1f2937;
  }

  @media (max-width: 768px) {
    .project-title {
      font-size: 1.875rem;
    }

    .findings-grid {
      grid-template-columns: 1fr;
    }

    .chart-container {
      padding: 1rem;
    }

    .comparison-grid {
      grid-template-columns: 1fr;
    }

    .crisis-grid {
      grid-template-columns: 1fr;
    }

    .freeze-stats {
      grid-template-columns: 1fr;
    }

    .fund-sources {
      grid-template-columns: 1fr;
    }
  }
</style>
